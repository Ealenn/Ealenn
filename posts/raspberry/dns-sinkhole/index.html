<!doctype html><html><head><title>DNS sinkhole, between Privacy and AdBlocker, configuration and feedback</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="ie=edge"><link rel=stylesheet href=https://ealen.fr/css/bootstrap.min.css><link rel=stylesheet href=https://ealen.fr/css/layouts/main.css><link rel=stylesheet href=https://ealen.fr/css/style.css><link rel=stylesheet href=https://ealen.fr/css/navigators/navbar.css><link href="https://fonts.googleapis.com/css2?family=Muli:wght@300;400;500;600" rel=stylesheet><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/all.min.css><link rel=icon type=image/png href=https://ealen.fr/images/site/favicon_hucfb824843c4f4113270da96ead535ce1_5638_42x0_resize_box_3.png><link rel=stylesheet href=https://ealen.fr/css/style.css><meta name=description content="Protect your devices from unwanted content and guard your privacy with a DNS sinkhole, without installing any client-side software."><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/styles/atom-one-dark.min.css><link rel=stylesheet href=https://ealen.fr/css/layouts/single.css><link rel=stylesheet href=https://ealen.fr/css/navigators/sidebar.css></head><body data-spy=scroll data-target=#TableOfContents data-offset=80><div class="container-fluid bg-dimmed wrapper"><nav class="navbar navbar-expand-xl top-navbar final-navbar shadow"><div class=container><button class="navbar-toggler navbar-light" id=sidebar-toggler type=button onclick=toggleSidebar()>
<span class=navbar-toggler-icon></span></button>
<a class=navbar-brand href=https://ealen.fr/><img src=https://ealen.fr/images/site/main-logo_huea7ec95f2c2fe9a67b35c3c43b5d9933_30968_42x0_resize_box_3.png>Ealen's Blog</a>
<button class="navbar-toggler navbar-light" id=toc-toggler type=button onclick=toggleTOC()>
<span class=navbar-toggler-icon></span></button><div class="collapse navbar-collapse lang-selector" id=top-nav-items><ul class="navbar-nav ml-auto"></ul></div></div><img src=https://ealen.fr/images/site/main-logo_huea7ec95f2c2fe9a67b35c3c43b5d9933_30968_42x0_resize_box_3.png class=d-none id=main-logo>
<img src=https://ealen.fr/images/site/inverted-logo_hu561b1c2b7fb8ec8a12c51a48d696c5e6_18657_42x0_resize_box_3.png class=d-none id=inverted-logo></nav><section class=sidebar-section id=sidebar-section><div class=sidebar-holder><div class=sidebar id=sidebar><input type=text placeholder=Search data-search id=search-box><div class=sidebar-tree><ul class=tree id=tree><li id=list-heading><a href=https://ealen.fr/posts data-filter=all>Posts</a></li><div class=subtree><li><i class="fas fa-minus-circle"></i><a class=active href=https://ealen.fr/posts/raspberry/>Raspberry</a><ul class=active><li><a class=active href=https://ealen.fr/posts/raspberry/dns-sinkhole/>DNS Sinkhole</a></li><li><a href=https://ealen.fr/posts/raspberry/nextcloud/>Private Cloud Drive</a></li></ul></li></div></ul></div></div></div></section><section class=content-section id=content-section><div class=content><div class="container p-0 read-area"><div class="hero-area col-sm-12" id=hero-area style=background-image:url(https://ealen.fr/posts/raspberry/dns-sinkhole/hero.jpg)></div><div class=page-content><div class="author-profile ml-auto align-self-lg-center"><img class=rounded-circle src=https://ealen.fr/images/author/rudy.jpg><h5 class=author-name>Rudy Marchandise</h5><p>January 2, 2021</p></div><div class=title><h1>DNS sinkhole, between Privacy and AdBlocker, configuration and feedback</h1></div><div class=post-content id=post-content><p>DNS sinkhole technology provides an effective shield against unwanted online content without the hassle of installing client-side software.
In this article, we&rsquo;ll explore how DNS sinkholes work, their advantages, and two leading solutions: Pi-Hole and AdGuard.</p><h2 id=introduction>Introduction</h2><h3 id=filtering>Filtering</h3><p>Filtering DNS queries plays a role in bolstering online security and safeguarding our digital privacy.</p><p>By intercepting and scrutinizing DNS requests, we can proactively block potential threats and security menaces before they even reach our devices. This not only shields us from malicious websites and phishing attempts but also adds an extra layer of defense against cyberattacks like malware distribution and ransomware.</p><p>Furthermore, DNS filtering empowers individuals to take control of their online privacy by thwarting the data-hungry scripts employed by big companies to harvest and monetize our personal information. By blocking these privacy sniffers, we can reduce the risk of our data being exploited for targeted advertising or other intrusive purposes.</p><p>Last but not least, DNS filtering is a potent tool for eliminating the incessant barrage of ads that clutter our browsing experience. It not only enhances our online efficiency but also minimizes the exposure to potentially deceptive or harmful advertisements.</p><p>In essence, DNS filtering serves as a versatile guardian of our digital world, fortifying our security, preserving our privacy, and decluttering our online landscape.</p><h3 id=dns-queries>DNS Queries</h3><p>DNS (Domain Name System) queries play a crucial role in converting web addresses (e.g., duckduckgo.com) into IP addresses that your devices can understand (e.g., 40.114.177.156).</p><img src=https://ealen.fr/posts/raspberry/dns-sinkhole/diagram/dns-query.png width=246 height=342 class=center><p>The DNS sinkhole operates as an intermediary between your DNS server and client devices, such as computers, TVs, tablets, and phones. Depending on your DNS sinkhole&rsquo;s configuration, it can either accept or deny requests based on a DNS Sinkhole List.
DNS sinkholes categorize queries into two lists: the allowlist and blocklist.</p><div class=row><div class="col col-sm-12 col-lg-6"><img src=./diagram/allow-list.png alt></p><hr></div><div class="col col-sm-12 col-lg-6"><img src=./diagram/block-list.png alt></div></div><blockquote><p><img src=./diagram/app.png alt> DNS-Sinkhole
<img src=./diagram/configuration-file.png alt> DNS-Sinkhole List
<img src=./diagram/dns.png alt> DNS Server
<img src=./diagram/arrow-blue.png alt> DNS-Sinkhole Request/Response
<img src=./diagram/arrow-red.png alt> DNS Request/Response</p></blockquote><h4 id=dns-sinkhole-list>DNS-Sinkhole List</h4><p>Here&rsquo;s a sample of DNS-Sinkhole Lists:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>amptrack.dailymail.co.uk <span style=color:#75715e>#DailyMail Tracker</span>
</span></span><span style=display:flex><span>analytics.gandi.net <span style=color:#75715e>#Gandi</span>
</span></span><span style=display:flex><span>analytics.yahoo.com <span style=color:#75715e>#Yahoo</span>
</span></span><span style=display:flex><span>arc.msn.com <span style=color:#75715e>#Microsoft</span>
</span></span><span style=display:flex><span>areyouahuman.com <span style=color:#75715e>#Are You A Human</span>
</span></span><span style=display:flex><span>atdmt.com <span style=color:#75715e>#Facebook</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#...</span>
</span></span></code></pre></div><p>By default, DNS-Sinkhole employs its own list, but you can easily add more from sources like GitHub. I created my own lists and I share them on GitHub at <a href=https://github.com/Ealenn/AdGuard-Home-List>Ealenn/AdGuard-Home-List</a>, which is suitable for corporate use and combines popular lists.</p><p>To configure AdGuard Home, use its main menu to add one blocklist and one allowlist:</p><p>BlockList :</p><ul><li><a href=https://raw.githubusercontent.com/Ealenn/AdGuard-Home-List/gh-pages/AdGuard-Home-List.Block.txt>https://raw.githubusercontent.com/Ealenn/AdGuard-Home-List/gh-pages/AdGuard-Home-List.Block.txt</a></li></ul><p>AllowList :</p><ul><li><a href=https://raw.githubusercontent.com/Ealenn/AdGuard-Home-List/gh-pages/AdGuard-Home-List.Allow.txt>https://raw.githubusercontent.com/Ealenn/AdGuard-Home-List/gh-pages/AdGuard-Home-List.Allow.txt</a></li></ul><h3 id=dns-server-redundancy>DNS Server Redundancy</h3><p>Another advantage of DNS sinkholes is the availability of multiple DNS servers.</p><p>If one DNS server becomes inaccessible, your system can automatically switch to another. This redundancy is crucial in scenarios like DDoS attacks, as seen <a href=https://en.wikipedia.org/wiki/2016_Dyn_cyberattack>in the 2016 Dyn cyberattack</a> and the 2018 French internet service provider Free DNS breakdown.</p><img src=https://ealen.fr/posts/raspberry/dns-sinkhole/diagram/multiple-dns.png width=437 height=352 class=center><p>Personally I use :</p><ul><li>Cloudflare, the fastest DNS resolver on Earth</li><li>Google</li><li>Cisco Open DNS</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span><span style=color:#75715e># AdGuard</span>
</span></span><span style=display:flex><span>94.140.14.14
</span></span><span style=display:flex><span>94.140.15.15
</span></span><span style=display:flex><span>https://dns.adguard.com/dns-query
</span></span><span style=display:flex><span>tls://dns.adguard.com
</span></span><span style=display:flex><span><span style=color:#75715e># Cloudflare DNS</span>
</span></span><span style=display:flex><span>1.1.1.1
</span></span><span style=display:flex><span>1.0.0.1
</span></span><span style=display:flex><span>https://dns.cloudflare.com/dns-query
</span></span><span style=display:flex><span>tls://1.1.1.1
</span></span><span style=display:flex><span><span style=color:#75715e># Google</span>
</span></span><span style=display:flex><span>8.8.8.8
</span></span><span style=display:flex><span>8.8.4.4
</span></span><span style=display:flex><span>https://dns.google/dns-query
</span></span><span style=display:flex><span>tls://dns.google
</span></span><span style=display:flex><span><span style=color:#75715e># Cisco OpenDNS</span>
</span></span><span style=display:flex><span>208.67.222.222
</span></span><span style=display:flex><span>208.67.220.220
</span></span><span style=display:flex><span>https://doh.opendns.com/dns-query
</span></span><span style=display:flex><span><span style=color:#75715e># Dyn DNS</span>
</span></span><span style=display:flex><span>216.146.35.35
</span></span><span style=display:flex><span>216.146.36.36
</span></span></code></pre></div><h2 id=concretely>Concretely</h2><h3 id=open-source-leaders>Open Source Leaders</h3><h4 id=pi-hole>Pi-Hole</h4><p><img src="https://img.shields.io/github/last-commit/pi-hole/pi-hole?style=flat-square" alt="GitHub last commit">
<img src="https://img.shields.io/github/stars/pi-hole/pi-hole?style=flat-square" alt="GitHub Repo stars">
<img src="https://img.shields.io/docker/pulls/pihole/pihole?style=flat-square" alt="Docker Pulls"></p><ul><li>Maintained by developers from the US, Canada, England, Germany, and Australia</li><li>Boasts a sizable community for easy support</li><li>Blocklists and allowlists are regularly updated and maintained by the developers</li></ul><h4 id=adguard>AdGuard</h4><p><img src="https://img.shields.io/github/last-commit/AdguardTeam/AdGuardHome?style=flat-square" alt="GitHub last commit">
<img src="https://img.shields.io/github/stars/AdguardTeam/AdGuardHome?style=flat-square" alt="GitHub Repo stars">
<img src="https://img.shields.io/docker/pulls/adguard/adguardhome?style=flat-square" alt="Docker Pulls"></p><ul><li>Most developers are located in Moscow, Russia</li><li>Cleaner interface compared to Pi-Hole</li><li>Utilizes fewer system resources (RAM)</li><li>Supports DNS-Over-HTTPS</li></ul><h3 id=web-interface>Web Interface</h3><p>Both Pi-Hole and AdGuard offer similar-looking main dashboards accessed via a web browser.
These dashboards provide useful statistics and graphs regarding the effectiveness of the ad blockers.</p><div class=row><div class="col col-sm-12 col-lg-6"><h3 id=pi-hole>Pi-Hole</h3><p><img src=./pi-hole.png alt></div><div class="col col-sm-12 col-lg-6"><h3 id=adguard>AdGuard</h3><p><img src=./adguard.png alt></div></div><h3 id=installation>Installation</h3><div class="alert alert-warning"><strong><strong>Note</strong>: Ensure your router (or DHCP server) assigns a static IP address to your DNS sinkhole.</strong></div><div class=row><div class="col col-sm-12 col-lg-6"><h4 id=pi-hole>Pi-Hole</h4><p>For more information, refer to the official Pi-Hole documentation <a href=https://docs.pi-hole.net/>here</a>.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yml data-lang=yml><span style=display:flex><span><span style=color:#f92672>version</span>: <span style=color:#e6db74>&#34;3&#34;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>services</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>pihole</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>container_name</span>: <span style=color:#ae81ff>pihole</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>image</span>: <span style=color:#ae81ff>pihole/pihole</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>ports</span>:
</span></span><span style=display:flex><span>      - <span style=color:#e6db74>&#34;53:53/tcp&#34;</span>
</span></span><span style=display:flex><span>      - <span style=color:#e6db74>&#34;53:53/udp&#34;</span>
</span></span><span style=display:flex><span>      - <span style=color:#e6db74>&#34;67:67/udp&#34;</span>
</span></span><span style=display:flex><span>      - <span style=color:#e6db74>&#34;8000:80/tcp&#34;</span>
</span></span><span style=display:flex><span>      - <span style=color:#e6db74>&#34;4443:443/tcp&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>environment</span>:
</span></span><span style=display:flex><span>      <span style=color:#f92672>TZ</span>: <span style=color:#e6db74>&#39;Europe/Paris&#39;</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>WEBPASSWORD</span>: <span style=color:#e6db74>&#39;Password used for Web Administration&#39;</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>ServerIP</span>: <span style=color:#e6db74>&#39;IP of Pi-Hole&#39;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>volumes</span>:
</span></span><span style=display:flex><span>      - <span style=color:#e6db74>&#39;./etc-pihole/:/etc/pihole/&#39;</span>
</span></span><span style=display:flex><span>      - <span style=color:#e6db74>&#39;./etc-dnsmasq.d/:/etc/dnsmasq.d/&#39;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>dns</span>:
</span></span><span style=display:flex><span>      - <span style=color:#ae81ff>1.1.1.1</span>
</span></span><span style=display:flex><span>      - <span style=color:#ae81ff>8.8.8.8</span>
</span></span><span style=display:flex><span>      - <span style=color:#ae81ff>8.8.4.4</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>cap_add</span>:
</span></span><span style=display:flex><span>      - <span style=color:#ae81ff>NET_ADMIN</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>restart</span>: <span style=color:#ae81ff>unless-stopped</span>
</span></span></code></pre></div></div><div class="col col-sm-12 col-lg-6"><h4 id=adguard>AdGuard</h4><p>For more information, refer to the official AdGuard Home documentation <a href=https://kb.adguard.com/en/home/overview>here</a>.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yml data-lang=yml><span style=display:flex><span><span style=color:#f92672>version</span>: <span style=color:#e6db74>&#34;3&#34;</span> 
</span></span><span style=display:flex><span><span style=color:#f92672>services</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>adguard</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>container_name</span>: <span style=color:#ae81ff>adguardhome</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>image</span>: <span style=color:#ae81ff>adguard/adguardhome</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>ports</span>:
</span></span><span style=display:flex><span>      - <span style=color:#e6db74>&#34;53:53/tcp&#34;</span>
</span></span><span style=display:flex><span>      - <span style=color:#e6db74>&#34;53:53/udp&#34;</span>
</span></span><span style=display:flex><span>      - <span style=color:#e6db74>&#34;67:67/udp&#34;</span>
</span></span><span style=display:flex><span>      - <span style=color:#e6db74>&#34;68:68/tcp&#34;</span>
</span></span><span style=display:flex><span>      - <span style=color:#e6db74>&#34;68:68/udp&#34;</span>
</span></span><span style=display:flex><span>      - <span style=color:#e6db74>&#34;8000:80/tcp&#34;</span>
</span></span><span style=display:flex><span>      - <span style=color:#e6db74>&#34;4443:443/tcp&#34;</span>
</span></span><span style=display:flex><span>      - <span style=color:#e6db74>&#34;853:853/tcp&#34;</span>
</span></span><span style=display:flex><span>      - <span style=color:#e6db74>&#34;3000:3000/tcp&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>volumes</span>:
</span></span><span style=display:flex><span>      - <span style=color:#ae81ff>./workdir:/opt/adguardhome/work</span>
</span></span><span style=display:flex><span>      - <span style=color:#ae81ff>./confdir:/opt/adguardhome/conf</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>dns</span>:
</span></span><span style=display:flex><span>      - <span style=color:#ae81ff>1.1.1.1</span>
</span></span><span style=display:flex><span>      - <span style=color:#ae81ff>8.8.8.8</span>
</span></span><span style=display:flex><span>      - <span style=color:#ae81ff>8.8.4.4</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>cap_add</span>:
</span></span><span style=display:flex><span>      - <span style=color:#ae81ff>NET_ADMIN</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>restart</span>: <span style=color:#ae81ff>unless-stopped</span>
</span></span></code></pre></div></div></div><hr><p>You have two options for implementation:</p><ul><li>use it as a DHCP server for automatic configuration</li><li>or manually configure the DNS server on your devices to use your Raspberry Pi&rsquo;s IP address.</li></ul><blockquote><p><strong>Personally, I&rsquo;ve configured my devices to use the DNS server.</strong></p></blockquote><h2 id=feedback>Feedback</h2><p>After using Pi-Hole for six months and AdGuard for another six months, both solutions proved nearly identical.
However, AdGuard Home offers a more appealing interface and easy DNS-Over-HTTPS setup.</p><p>It&rsquo;s important to note that DNS sinkholes can&rsquo;t block all ads or junk content, as some domains serve multiple purposes. For now, domains like Facebook, YouTube, or Google can&rsquo;t be entirely blocked without causing functionality issues.</p><p>Nevertheless, DNS sinkholes can effectively block a substantial portion of unwanted content. On my network, with AdGuard, approximately 10-20 percent of DNS requests are refused, effectively blocking ads and enhancing privacy.</p><div class=row><div class="col col-sm-12 col-lg-6"><p>Ads</p><ul><li>adservice.google.com</li><li>ads.yahoo.com</li><li>&mldr;</li></ul></div><div class="col col-sm-12 col-lg-6"><p>Privacy</p><ul><li>metrics.***.com</li><li>app-measurement.com</li><li>analytics.***.com</li><li>privatestats.whatsapp.net</li><li>&mldr;</li></ul></div></div></div><div class=btn-improve-page><a href=https://github.com/Ealenn/Ealenn/edit//content/posts/raspberry/dns-sinkhole/index.md><i class="fas fa-code-branch"></i>
Improve this page</a></div><hr><div class="row next-prev-navigator"><div class="col-md-6 previous-article"><a href=https://ealen.fr/posts/raspberry/nextcloud/ class="btn btn-outline-info"><span><i class="fas fa-chevron-circle-left"></i> Prev</span><br><span>Nextcloud: The Ultimate Solution to Replace Google Drive and Others</span></a></div></div><hr></div></div></div></section><section class=toc-section id=toc-section><div class=toc-holder><h5 class="text-center pl-3">Table of Contents</h5><hr><div class=toc><nav id=TableOfContents><ul><li><a href=#introduction>Introduction</a><ul><li><a href=#filtering>Filtering</a></li><li><a href=#dns-queries>DNS Queries</a><ul><li><a href=#dns-sinkhole-list>DNS-Sinkhole List</a></li></ul></li><li><a href=#dns-server-redundancy>DNS Server Redundancy</a></li></ul></li><li><a href=#concretely>Concretely</a><ul><li><a href=#open-source-leaders>Open Source Leaders</a><ul><li><a href=#pi-hole>Pi-Hole</a></li><li><a href=#adguard>AdGuard</a></li></ul></li><li><a href=#web-interface>Web Interface</a></li><li><a href=#installation>Installation</a></li></ul></li><li><a href=#feedback>Feedback</a></li></ul></nav></div></div></section></div><footer class="container-fluid text-center align-content-center footer pb-2"><div class="container pt-5"><div class="row text-left"><div class="col-md-4 col-sm-12"><h5>Navigation</h5><ul><li class=nav-item><a class=smooth-scroll href=#about>About</a></li><li class=nav-item><a class=smooth-scroll href=#recent-posts>Recent Posts</a></li><li class=nav-item><a class=smooth-scroll href=#projects>Projects</a></li><li class=nav-item><a class=smooth-scroll href=#experiences>Experiences</a></li><li class=nav-item><a class=smooth-scroll href=#education>Education</a></li></ul></div><div class="col-md-4 col-sm-12"><h5>Contact me:</h5><ul><li><span>Email:</span> <span>contact@ealen.fr</span></li></ul></div></div></div><hr><div class=container><div class="row text-left"><div class=col-md-4><a id=theme href=https://github.com/hossainemruz/toha target=#><img src=https://ealen.fr/images/theme-logo_hu8376fd15465fef26ffe66b6bcf0ca686_13669_32x0_resize_box_3.png>
Toha</a></div><div class="col-md-4 text-center">© 2021 Copyright.</div><div class="col-md-4 text-right"><a id=hugo href=https://gohugo.io/>Powered by
<img src=https://ealen.fr/images/hugo-logo.svg alt="Hugo Logo" height=18></a></div></div></div></footer><script src=https://ealen.fr/js/jquery-3.4.1.min.js></script>
<script src=https://ealen.fr/js/popper.min.js></script>
<script src=https://ealen.fr/js/bootstrap.min.js></script>
<script src=https://ealen.fr/js/navbar.js></script>
<script src=https://ealen.fr/js/main.js></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/highlight.min.js></script>
<script src=https://ealen.fr/js/single.js></script>
<script>hljs.initHighlightingOnLoad()</script></body></html>